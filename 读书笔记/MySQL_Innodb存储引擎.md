### 一、MySQL体系结构



基本概念：

> 数据库：物理操作系统文件和其他文件类型的集合。
>
> 实例：MySQL数据库有后台线程以及共享内存区构成，实例在系统上就是一个进程，用来操作数据库文件。

配置文件：

![1610079489890](..\resource\mysql启动文件顺序.png)

> MySQL启动时以以上顺序读取配置文件，并以最后一个文件为准

#### 1. MySQL体系结构

![img](..\resource\mysql体系架构.png)



**连接池组件**：将连接缓存，下次可以直接用已经建立好的连接，减少创建连接时间，提升服务器性能。

**管理服务和工具组件**：系统管理和控制工具，例如备份恢复、Mysql复制、集群等

**SQL接口组件**：接受用户的SQL命令，并且返回用户需要查询的结果。比如select from就是调用SQL Interface

**查询分析器组件:** SQL命令传递到解析器的时候会被解析器验证和解析。

**优化器组件**：查询优化器，SQL语句在查询之前会使用查询优化器对查询进行优化。

**缓冲组件：** 查询缓存，如果查询缓存有命中的查询结果，查询语句就可以直接去查询缓存中取数据。

**插件式存储引擎：**MySQL中 **存储引擎是基于表**

**物理文件**

#### 2.存储引擎

##### 2.1 InnoDB存储引擎

特点：支持事务、行锁、外键、类Oracle的非锁定读（默认读操作不会产生锁）、多版本并发控制（MVCC）获得高并发、4种隔离级别（默认repeatable）、next-keylocking避免幻读

高性能高可用功能：插入缓冲（insert buffer）、二次写（double write）、自适应哈希索引（adaptive hash index）、预读（read ahead）......

表数据存储：聚集方式-----按主键顺序进行存放（如没有定义主键，默认生成6字节的rowid作为主键）

##### 2.2 MyISAM存储引擎

特点：不支持事务，表锁、全文索引、缓冲池只缓存索引文件，不缓冲数据文件

存储：MYD（数据）和MYI（索引）文件

##### 常用存储引擎对比

![](..\resource\mysql存储引擎对比.png)

### 二、InnoDB存储引擎

